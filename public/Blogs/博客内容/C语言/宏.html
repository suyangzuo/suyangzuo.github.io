<article class="专题简介">
  <h1 class="简介标题">宏<span class="转载">转载</span></h1>
  <div class="简介信息">
    <section class="简介信息文本">
      <p class="作者">
        <span class="作者前缀 前缀">作者：</span>
        <span class="作者姓名">Shaurya Singhal</span>
      </p>
      <p class="译者">
        <span class="译者前缀 前缀">译者：</span>
        <span class="译者姓名">苏扬</span>
      </p>
      <p class="原文">
        <span class="原文前缀 前缀">原文：</span>
        <span class="原文链接"
          ><a
            class="超链接"
            target="_blank"
            href="https://www.codingninjas.com/studio/library/c-macros"
            >https://www.codingninjas.com/studio/library/c-macros</a
          ></span
        >
      </p>
      <p class="日期">
        <span class="日期前缀 前缀">日期：</span>
        <span class="日期文本"><span class="日期文本-数字 日期文本-年">2024</span>年<span class="日期文本-数字 日期文本-月">1</span>月<span class="日期文本-数字 日期文本-日">20</span>日</span>
      </p>
    </section>
    <section class="简介信息图像">
      <img src="/Images/Contributors/苏扬.jpg" alt="苏扬" />
    </section>
  </div>
  <ul class="联系方式列表">
    <li class="联系方式项">
      <a class="联系方式链接" href="mailto:suyangzuo@gmail.com" target="_blank">
        <i class="fa-solid fa-envelope"></i>
      </a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://github.com/suyangzuo"
        target="_blank"
        ><i class="fa-brands fa-github"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://www.deviantart.com/suyangzuo"
        target="_blank"
        ><i class="fa-brands fa-deviantart"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a class="联系方式链接" href="https://dev.to/suyangzuo" target="_blank"
        ><i class="fa-brands fa-dev"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://www.freecodecamp.org/suyangzuo"
        target="_blank"
        ><i class="fa-brands fa-free-code-camp"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://codepen.io/suyangzuo"
        target="_blank"
        ><i class="fa-brands fa-codepen"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://dribbble.com/suyangzuo"
        target="_blank"
        ><i class="fa-brands fa-dribbble"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://www.artstation.com/user-7893655"
        target="_blank"
        ><i class="fa-brands fa-artstation"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://codesandbox.io/u/suyangzuo"
        target="_blank"
      >
        <img src="/Images/Page-Logos/CodeSandbox.png" alt="CodeSandbox"
      /></a>
    </li>
  </ul>
</article>

<div class="专题正文区">
  <article class="正文分区">
    <section class="提醒 转载提醒">
      <h3 class="提醒标题">提醒</h3>
    </section>
  </article>
  <article class="正文分区">
    <h2 class="分区标题 分区2级标题">
      <span class="行内专业名词">宏</span>是什么
    </h2>

    <h3 class="分区标题 分区3级标题">
      <span class="行内专业名词">宏</span>是<span class="行内专业名词"
        >代码片段</span
      >
    </h3>
    <p class="分区普通文本">
      <span class="行内专业名词">宏</span>是命名的代码片段，编译器在遇到<span
        class="行内专业名词"
        >宏名称</span
      >时，会将其替换成<span class="行内专业名词">宏内容</span
      >。宏用于定义常量或表达式，可以在代码的任何位置调用宏。
    </p>
    <p class="分区普通文本">假设有如下宏定义：</p>
    <pre>
      <code class="lang-c">
        #define PI 3.1415926
      </code>
    </pre>
    <p class="分区普通文本">
      用<span class="代码">#define</span>命令来定义宏；宏名称：<span
        class="代码"
        >PI</span
      >，宏内容：<span class="代码">3.1415926</span
      >，编译器进行编译时，会将所有写着<span class="行内代码">PI</span
      >的代码直接替换成<span class="行内代码">3.1415926</span>。
    </p>
  </article>

  <article class="正文分区">
    <h2 class="分区标题 分区2级标题">
      <span class="行内专业名词">宏</span>的类型
    </h2>

    <h3 class="分区标题 分区3级标题">
      <span class="行内专业名词">对象式</span>宏
    </h3>
    <pre class="line-numbers">
      <code class="lang-c">
        #include &lt;stdio.h&gt;

        ///下面是2个对象式宏
        #define PI 3.1415926
        #define NAME "祖冲之"

        int main(int argc, char* argv[]) {
            // PI会被 3.1415926 代替，NAME会被 "祖冲之" 代替
            printf("%s发现了圆周率，它的值近似于：%.7lf\n", NAME, PI);
        }
      </code>
    </pre>
    <figure class="截图容器">
      <img src="/Images/Blogs/C语言/宏/对象式宏.gif" alt="对象式宏" />
    </figure>
    <p class="分区普通文本">
      <span class="代码">PI</span>和<span class="代码">name</span>是 2 个<span
        class="行内专业名词"
        >对象式宏</span
      >。编译器在编译时，会将代码中所有的<span class="代码">PI</span>替换成<span
        class="代码"
        >3.1415926</span
      >，将所有的<span class="代码">name</span>替换成<span class="代码"
        >"祖冲之"</span
      >。
    </p>

    <h3 class="分区标题 分区3级标题">
      <span class="行内专业名词">函数式</span>宏
    </h3>
    <p class="分区普通文本">
      函数式宏和C语言中的函数类似。它可以像函数一样传入参数。要定义一个带参数的函数式宏，就要把参数放到圆括号内。参数必须是正确的C语言标识符，多个参数之间用逗号隔开。我们同样可以添加空格：
    </p>
    <pre class="line-numbers">
      <code class="lang-c">
        #include &lt;stdio.h&gt;

        // 下面是2个函数式宏
        #define GET_PERIMETER(width, height) ((width + height) * 2)
        #define GET_AREA(width, height) (width * height);
          
        int main(int argc, char* argv[]) {
            int width = 40;
            int height = 85;

            //调用函数式宏，求矩形周长
            int perimeter = GET_PERIMETER(width, height);

            //调用函数式宏，求矩形面积
            int area = GET_AREA(width, height);

            printf("矩形的周长：%d\n矩形的面积：%d\n", perimeter, area);
        }
          
      </code>
    </pre>
    <figure class="截图容器">
      <img src="/Images/Blogs/C语言/宏/函数式宏.gif" alt="函数式宏" />
    </figure>
    <p class="分区普通文本">
      <span class="代码">getPerimeter(width, height)</span>和<span class="代码"
        >getArea(width, height)</span
      >是 2 个<span class="行内专业名词">函数式宏</span
      >。函数式宏在被调用时，名称后必须紧跟配对的圆括号，如果只写名称，则不会产生作用。这在定义了名称相同的函数和函数式宏的情况下非常有用：名称加括号，调用函数式宏；只写名称，调用函数。
    </p>
    <section class="提醒">
      <h3 class="提醒标题">提醒</h3>
      <p>
        定义函数式宏，宏内容必须圆括号包起来；此外，宏名称和紧跟其后的圆括号之间不能有空格，否则会被认为是对象式宏。
      </p>
    </section>

    <h3 class="分区标题 分区3级标题">
      <span class="行内专业名词">多行</span>宏
    </h3>
    <p class="分区普通文本">
      多行宏其实是对象式宏的扩展。要使用多行宏，可用反斜杠<span class="代码"
        >\</span
      >换行。
    </p>
    <pre class="line-numbers">
      <code class="lang-c">
        #include &lt;stdio.h&gt;

          // 下面是一个多行宏
          #define CREW_NAMES 35,\
          42,\
          31
          
          int main(int argc, char* argv[]) {
              // 多行宏在此处自动替换为数组中的元素
              int crew_names[3] = { CREW_NAMES };
          
              for (int i = 0; i &lt; 3; i++) {
                  printf("%d号团队成员年龄：%d\n", i + 1, crew_names[i]);
              }
          }
      </code>
    </pre>
    <figure class="截图容器">
      <img src="/Images/Blogs/C语言/宏/多行宏.gif" alt="多行宏" />
    </figure>
    <p class="分区普通文本">
      宏名称在编译时被替换成宏内容，多个数字用逗号隔开，变成了数组中的元素。
    </p>

    <h3 class="分区标题 分区3级标题">
      <span class="行内专业名词">预定义</span>宏
    </h3>
    <p class="分区普通文本">
      C语言中有几个特别的预定义宏，开发人员可直接使用，无需自己定义，但也无法修改它们。
    </p>
    <ul class="分区列表">
      <li class="分区列表项">
        <span class="代码">__DATE__</span>：以字符串形式显示当前日期
      </li>
      <li class="分区列表项">
        <span class="代码">__TIME__</span>：以字符串形式显示当前时间
      </li>
      <li class="分区列表项">
        <span class="代码">__FILE__</span>：以字符串形式显示当前文件名
      </li>
      <li class="分区列表项">
        <span class="代码">__LINE__</span>：以字符串形式显示当前代码所在行
      </li>
      <li class="分区列表项">
        <span class="代码">__STDC__</span>：如果编译器使用<span class="行内代码"
          >ANSI</span
        >标准，则显示<span class="行内代码">1</span>
      </li>
    </ul>
    <section class="提醒">
      <h3 class="提醒标题">提醒</h3>
      <p>
        预定义宏名称包含了一种特殊符号：字下线<span class="代码">_</span
        >；以双字下线开头，也以双字下线结尾，例如：只写<span class="代码"
          >FILE</span
        >是<span class="强调">错</span>的，应该写成：<span class="代码"
          >__FILE__</span
        >。
      </p>
    </section>
  </article>

  <article class="正文分区">
    <h2 class="分区标题 分区2级标题">常见问题</h2>

    <h3 class="分区标题 分区3级标题">
      <span class="行内专业名词">宏</span>存储在哪里
    </h3>
    <p class="分区普通文本">
      宏不会存储在内存中；相反，每次在代码中遇到宏都会调用它。
    </p>

    <h3 class="分区标题 分区3级标题">
      <span class="行内专业名词">宏</span>的作用是什么
    </h3>
    <p class="分区普通文本">宏可以降低代码的冗余度，提高代码效率和可读性。</p>

    <h3 class="分区标题 分区3级标题">
      相较于函数，<span class="行内专业名词">宏</span>有何优势
    </h3>
    <p class="分区普通文本">宏更快、更高效。</p>
  </article>
</div>
