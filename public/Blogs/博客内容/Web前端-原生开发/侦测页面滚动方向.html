<article class="专题简介">
  <h1 class="简介标题">侦测页面滚动方向<span class="转载">转载</span></h1>
  <div class="简介信息">
    <section class="简介信息文本">
      <p class="作者">
        <span class="作者前缀 前缀">作者：</span>
        <span class="作者姓名">Borislav Hadzhiev</span>
      </p>
      <p class="译者">
        <span class="译者前缀 前缀">译者：</span>
        <span class="译者姓名">苏扬</span>
      </p>
      <p class="原文">
        <span class="原文前缀 前缀">原文：</span>
        <span class="原文链接"
          ><a
            class="超链接"
            target="_blank"
            href="https://bobbyhadz.com/blog/detect-the-scroll-direction-using-javascript"
            >https://bobbyhadz.com/blog/detect-the-scroll-direction-using-javascript</a
          ></span
        >
      </p>
      <p class="日期">
        <span class="日期前缀 前缀">日期：</span>
        <span class="日期文本"><span class="日期文本-数字 日期文本-年">2024</span>年<span class="日期文本-数字 日期文本-月">2</span>月<span class="日期文本-数字 日期文本-日">4</span>日</span>
      </p>
    </section>
    <section class="简介信息图像">
      <img src="/Images/Contributors/苏扬.jpg" alt="苏扬" />
    </section>
  </div>
  <ul class="联系方式列表">
    <li class="联系方式项">
      <a class="联系方式链接" href="mailto:suyangzuo@gmail.com" target="_blank">
        <i class="fa-solid fa-envelope"></i>
      </a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://github.com/suyangzuo"
        target="_blank"
        ><i class="fa-brands fa-github"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://www.deviantart.com/suyangzuo"
        target="_blank"
        ><i class="fa-brands fa-deviantart"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a class="联系方式链接" href="https://dev.to/suyangzuo" target="_blank"
        ><i class="fa-brands fa-dev"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://www.freecodecamp.org/suyangzuo"
        target="_blank"
        ><i class="fa-brands fa-free-code-camp"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://codepen.io/suyangzuo"
        target="_blank"
        ><i class="fa-brands fa-codepen"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://dribbble.com/suyangzuo"
        target="_blank"
        ><i class="fa-brands fa-dribbble"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://www.artstation.com/user-7893655"
        target="_blank"
        ><i class="fa-brands fa-artstation"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a
        class="联系方式链接"
        href="https://codesandbox.io/u/suyangzuo"
        target="_blank"
      >
        <img src="/Images/Page-Logos/CodeSandbox.png" alt="CodeSandbox"
      /></a>
    </li>
  </ul>
</article>
<div class="专题正文区">
  <article class="正文分区">
    <section class="提醒 转载提醒">
      <h3 class="提醒标题">提醒</h3>
    </section>
  </article>

  <article class="正文分区">
    <h2 class="分区标题 分区2级标题">
      使用<span class="行内代码">window.scrollY</span>
    </h2>

    <h3 class="分区标题 分区3级标题">
      <span class="行内代码">window.scrollY</span>是什么
    </h3>
    <p class="分区普通文本">
      <span class="行内代码">window.scrollY</span
      ><a
        class="超链接"
        target="_blank"
        href="https://developer.mozilla.org/zh-CN/docs/Web/API/window/scrollY"
        >返回文档在垂直方向已滚动的像素值。</a
      >
    </p>
    <figure class="截图容器">
      <img
        src="/Images/Blogs/Web前端-原生开发/侦测鼠标滚动方向/window.scrollY.png"
        alt="window.scrollY"
      />
    </figure>
    <p class="分区普通文本">
      从网页最顶端，到浏览器视口最顶端，这段距离就是<span class="行内代码"
        >window.scrollY</span
      >。
    </p>
    <section class="提醒">
      <h3 class="提醒标题">提醒</h3>
      <p>
        作者在<a
          class="超链接"
          target="_blank"
          href="https://bobbyhadz.com/blog/detect-the-scroll-direction-using-javascript"
          >原文</a
        >中使用了<span class="专业名词">后备值</span>：
      </p>
      <pre>
        <code class="lang-js">
          // 默认返回 window.scrollY
          // 如果 window.scrollY 为 null，则返回 document.documentElement.scrollTop
          window.scrollY || document.documentElement.scrollTop
        </code>
      </pre>
      <p>
        <span class="强调">此处到底需不需要使用后备值？</span>译者认为：<span
          class="强调"
          >不需要</span
        >。
      </p>
      <p>
        首先来看看<span class="代码">document.documentElement.scrollTop</span
        >是什么？<br />
        <span class="行内代码">document.documentElement</span>会<a
          class="超链接"
          target="_blank"
          href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document/documentElement"
          >返回文档的根元素</a
        >，也就是<span class="行内代码">&lt;html&gt;</span>。<br /><span
          class="行内代码"
          >scrollTop</span
        >属性可以<a
          class="超链接"
          target="_blank"
          href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/scrollTop"
          >获取或设置一个元素的内容垂直滚动的像素数</a
        >。
      </p>
      <p>
        结合起来，<span class="行内代码"
          >document.documentElement.scrollTop</span
        >可以获取<span class="行内专业名词">根元素</span
        >的内容垂直滚动的像素数。
      </p>
      <p>
        然而，在<a
          class="超链接"
          target="_blank"
          href="https://www.w3.org/TR/2016/WD-cssom-view-1-20160317/#dom-element-scrolltop"
          >W3C 工作草案</a
        >中对于<span class="行内代码">scrollTop</span>属性的规则中写到：<span
          class="强调"
          >如果调用<span class="行内代码">scrollTop</span
          >的是根元素，则返回<span class="行内代码">window.scrollY</span></span
        >。
      </p>
      <figure class="截图容器">
        <img
          src="/Images/Blogs/Web前端-原生开发/侦测鼠标滚动方向/W3C-工作草案.png"
          alt="W3C 工作草案 scrollY"
        />
      </figure>
      <p class="分区普通文本">
        在 W3C 草案中，<span class="代码"
          >document.documentElement.scrollTop</span
        >和<span class="代码">window.scrollY</span
        >是一回事，因此在本文后续内容中，译者将仅使用<span class="行内代码"
          >window.scrollY</span
        >以简化代码。
      </p>
    </section>

    <h3 class="分区标题 分区3级标题">
      <span class="行内代码">window.scrollY</span>与滚动方向的关系
    </h3>
    <p class="分区普通文本">
      与数学的轴不同，在编程领域，跟用户界面有关的部分，Y轴的值向下增加，向上减少。
    </p>
    <figure class="截图容器">
      <img
        src="/Images/Blogs/Web前端-原生开发/侦测鼠标滚动方向/window.scrollY-随滚动变化.gif"
        alt="window.scrollY 随滚动变化"
      />
    </figure>
    <p class="分区普通文本">
      向下滚动，<span class="行内代码">window.scrollY</span
      >的值增加；向上滚动，<span class="行内代码">window.scrollY</span
      >的值减少。通过值的变化，就可以判断滚动的方向。
    </p>

    <h3 class="分区标题 分区3级标题">具体实现</h3>
    <p class="分区普通文本">
      为了获取页面滚动方向，需要设置 2 个滚动值，一<span class="行内专业名词"
        >旧</span
      >一<span class="行内专业名词">新</span>，比较二者的差异即可得知滚动方向。
      每一次页面滚动都要进行比较，因此必须将相关函数绑定到<span class="行内代码"
        >window</span
      >的<span class="行内代码">scroll</span>事件上。
    </p>
    <pre class="line-numbers">
      <code class="lang-js">
        let 旧滚动值 = 0;

        window.addEventListener("scroll", () =&gt; {
          const 新滚动值 = window.scrollY;

          if (新滚动值 &gt; 旧滚动值) {
            console.log("下 ↓");
          } else {
            console.log("上 ↑");
          }

          旧滚动值 = 新滚动值;
        });
      </code>
    </pre>
    <figure class="截图容器">
      <img
        src="/Images/Blogs/Web前端-原生开发/侦测鼠标滚动方向/scroll事件-window.scrollY-滚动结果.gif"
        alt="滚动效果"
      />
    </figure>
  </article>

  <article class="正文分区">
    <h2 class="分区标题 分区2级标题">
      使用<span class="行内代码">WheelEvent.deltaY</span>
    </h2>

    <h3 class="分区标题 分区3级标题">
      <span class="行内代码">WheelEvent.deltaY</span>是什么
    </h3>
    <p class="分区普通文本">
      <span class="行内代码">WheelEvent.deltaY</span>表示<a
        class="超链接"
        target="_blank"
        href="https://developer.mozilla.org/zh-CN/docs/Web/API/WheelEvent/deltaY"
        >鼠标滚轮垂直方向的滚动量</a
      >。
    </p>
    <section class="提醒">
      <h3 class="提醒标题">提醒</h3>
      <p>
        <span class="行内代码">WheelEvent.deltaY</span>是配合<span
          class="行内代码"
          >wheel</span
        >事件使用的，而<span class="行内代码">window.scrollY</span>是配合<span
          class="行内代码"
          >scroll</span
        >事件使用。这两个事件有何区别呢？
      </p>
      <p>
        <span class="行内代码">WheelEvent.deltaY</span>代表的是<span
          class="专业名词"
          >鼠标滚轮的滚动</span
        >，而<span class="行内代码">window.scrollY</span>代表的是<span
          class="专业名词"
          >页面的滚动</span
        >。二者有时是一致的，但也有不一致的时候<span class="附加说明"
          >鼠标滚轮滚动不一定会导致页面滚动</span
        >。因此，<span class="行内专业名词">MDN Web Docs</span>建议<a
          class="超链接"
          target="_blank"
          href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/wheel_event"
          ><span class="强调">不要</span> 依赖
          <span class="行内代码">wheel</span> 事件的
          <span class="行内代码">WheelEvent.deltaY</span> 属性来获取滚动方向</a
        >。
      </p>
      <figure class="截图容器">
        <img
          src="/Images/Blogs/Web前端-原生开发/侦测鼠标滚动方向/MDN-滚轮事件-备注.png"
          alt="MDN 滚轮事件 备注"
        />
      </figure>
      <p class="分区普通文本">
        滚轮的滚动，不一定就是整个页面的滚动，也可能是页面内某个元素的滚动，因此用滚轮滚动事件判断页面的滚动方向并不可靠。到底要不要用，取决于整体页面实现；如果页面上没有其它元素会影响页面滚动，用用也无妨。
      </p>
    </section>

    <h3 class="分区标题 分区3级标题">
      <span class="行内代码">WheelEvent.deltaY</span>与滚动方向的关系
    </h3>
    <p class="分区普通文本">
      <span class="行内代码">WheelEvent.deltaY</span
      >比较简单，每滚一次都是固定的数字<span class="附加说明"
        >滚得快可能会按倍数变大</span
      >，不会叠加也不会减少，因此也不需要比较新旧。
    </p>
    <figure class="截图容器">
      <img
        src="/Images/Blogs/Web前端-原生开发/侦测鼠标滚动方向/滚轮滚动事件.gif"
        alt="滚轮滚动事件"
      />
    </figure>
    <p class="分区普通文本">
      向下滚动为正值，向上滚动为负值。具体数字跟操作系统鼠标设置中的滚动量有关，不一定是
      150。
    </p>

    <h3 class="分区标题 分区3级标题">具体实现</h3>
    <p class="分区普通文本">
      因为仅用正负值就可以判断滚轮方向，不需要比较新旧，因此代码简洁了许多：
    </p>
    <pre class="line-numbers">
      <code class="lang-js">
        window.addEventListener("wheel", (event) =&gt; {
          const 鼠标滚轮滚动值 = event.deltaY;

          if (鼠标滚轮滚动值 &gt; 0) {
            console.log("下 ↓");
          } else {
            console.log("上 ↑");
          }
        });
      </code>
    </pre>
    <figure class="截图容器">
      <img
        src="/Images/Blogs/Web前端-原生开发/侦测鼠标滚动方向/wheel事件-滚动效果.gif"
        alt="wheel事件 滚动效果"
      />
    </figure>
    <p class="分区普通文本">
      按照滚轮的方向可以获取页面滚动的效果。<span class="强调">再次强调</span
      >：此方式不可靠，要去看页面上是否有其它可以被滚轮操作的元素。如果有的话，尽量别用此方法。
    </p>
    <section class="提醒">
      <h3 class="提醒标题">提醒</h3>
      <p>
        如果你看了原文，会发现原文中使用了<span class="代码"
          >WheelEvent.wheelDelta</span
        >这个属性：
      </p>
      <figure class="截图容器">
        <img
          src="/Images/Blogs/Web前端-原生开发/侦测鼠标滚动方向/原文-wheelDelta.png"
          alt="原文 wheelDelta"
        />
      </figure>
      <p class="分区普通文本">
        作者使用了<span class="代码">WheelEvent.wheelDelta</span
        >，此属性实际上已被废弃：
      </p>
      <figure class="截图容器">
        <img
          src="/Images/Blogs/Web前端-原生开发/侦测鼠标滚动方向/WheelEvent.wheelDelta-被废弃.png"
          alt="WheelEvent.wheelDelta 被废弃"
        />
      </figure>
      <p class="分区普通文本">
        <span class="行内专业名词">MDN Web Docs</span>上已注明不要再使用此属性。
      </p>
    </section>
  </article>
</div>
