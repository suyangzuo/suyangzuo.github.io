<article class="专题简介">
  <h1 class="简介标题">
    <span>数组字符串<span class="次要">和</span>指针字符串</span><span class="原创">原创</span>
  </h1>
  <div class="简介信息">
    <section class="简介信息文本">
      <p class="作者">
        <span class="作者前缀 前缀">作者：</span>
        <span class="作者姓名">苏扬</span>
      </p>
      <p class="日期">
        <span class="日期前缀 前缀">日期：</span>
        <span class="日期文本"><span class="日期文本-数字 日期文本-年">2024</span>年<span class="日期文本-数字 日期文本-月">3</span>月<span class="日期文本-数字 日期文本-日">28</span>日</span>
      </p>
    </section>
    <section class="简介信息图像">
      <img src="/Images/Contributors/苏扬.jpg" alt="苏扬" />
    </section>
  </div>
  <ul class="联系方式列表">
    <li class="联系方式项">
      <a class="联系方式链接" href="mailto:suyangzuo@gmail.com" target="_blank">
        <i class="fa-solid fa-envelope"></i>
      </a>
    </li>
    <li class="联系方式项">
      <a class="联系方式链接" href="https://github.com/suyangzuo" target="_blank"
        ><i class="fa-brands fa-github"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a class="联系方式链接" href="https://www.deviantart.com/suyangzuo" target="_blank"
        ><i class="fa-brands fa-deviantart"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a class="联系方式链接" href="https://dev.to/suyangzuo" target="_blank"><i class="fa-brands fa-dev"></i></a>
    </li>
    <li class="联系方式项">
      <a class="联系方式链接" href="https://www.freecodecamp.org/suyangzuo" target="_blank"
        ><i class="fa-brands fa-free-code-camp"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a class="联系方式链接" href="https://codepen.io/suyangzuo" target="_blank"
        ><i class="fa-brands fa-codepen"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a class="联系方式链接" href="https://dribbble.com/suyangzuo" target="_blank"
        ><i class="fa-brands fa-dribbble"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a class="联系方式链接" href="https://www.artstation.com/user-7893655" target="_blank"
        ><i class="fa-brands fa-artstation"></i
      ></a>
    </li>
    <li class="联系方式项">
      <a class="联系方式链接" href="https://codesandbox.io/u/suyangzuo" target="_blank">
        <img src="/Images/Page-Logos/CodeSandbox.png" alt="CodeSandbox"
      /></a>
    </li>
  </ul>
</article>

<div class="专题正文区">
  <article class="正文分区">
    <h2 class="分区标题 分区2级标题">异同</h2>

    <h3 class="分区标题 分区3级标题">相同</h3>
    <ul class="分区列表">
      <li class="分区列表项">以<span class="代码">'\0'</span>字符结束</li>
      <li class="分区列表项">变量名<span class="强调">可用作</span>指向字符串第 1 个字符的指针</li>
      <li class="分区列表项">使用<span class="行内代码">%s</span>格式说明符。</li>
      <li class="分区列表项">
        可作为参数传递
        <section class="提醒">
          <h3 class="提醒标题">提醒</h3>
          <p>
            在 C语言 中，即使参数是数组，实际上传递的还是指针，从而导致无法识别数组的长度，这种现象称为<span
              class="行内专业名词"
              >数组退化</span
            >。解决方法是：将数组长度作为另一个参数传递，详情可参阅<a
              class="超链接"
              target="_blank"
              href="/Blogs/index.html?tech=C语言&article=数组和指针"
              >数组和指针</a
            >第 2 章。
          </p>
        </section>
      </li>
    </ul>

    <h3 class="分区标题 分区3级标题">差别</h3>
    <ul class="分区列表">
      <li class="分区列表项">
        字符串变量
        <ul class="分区列表">
          <li class="分区列表项">
            <span class="行内专业名词">以数组形式初始化：</span>变量就是数组，可<span class="强调">当做</span
            >指针使用，但<span class="强调">不是</span>指针类型，<span class="强调">不可</span>重新赋值。
          </li>
          <li class="分区列表项">
            <span class="行内专业名词">以指针形式初始化：</span>变量<span class="强调">是</span>指针类型，<span
              class="强调"
              >可以</span
            >重新赋值。
          </li>
        </ul>
      </li>
      <li class="分区列表项">
        字符串数据
        <ul class="分区列表">
          <li class="分区列表项">
            <span class="行内专业名词">以数组形式初始化：</span>分配在内存<span class="强调">栈</span>，可以修改。
          </li>
          <li class="分区列表项">
            <span class="行内专业名词">以指针形式初始化：</span>分配在内存<span class="强调">静态存储区</span
            >，无法修改。
          </li>
        </ul>
      </li>
    </ul>
  </article>

  <article class="正文分区">
    <h2 class="分区标题 分区2级标题">数组字符串</h2>

    <h3 class="分区标题 分区3级标题">初始化</h3>
    <p class="分区普通文本">
      字符串对象的初始化写法主要有两种：<span class="行内专业名词">单引号字符数组</span>和<span class="行内专业名词"
        >双引号字符串</span
      >
    </p>
    <ul class="分区列表">
      <li class="分区列表项">
        单引号字符数组
        <pre class="line-numbers">
          <code class="lang-c">
            //最后一个字符必须是'\0'
            //既是字符数组，也是字符串
            char name[7] = {'s', 'u', 'y', 'a', 'n', 'g', '\0'}; //正确的字符串写法
            
            //只是字符数组，不是字符串
            char name[6] = {'s', 'u', 'y', 'a', 'n', 'g'}; //错误的字符串写法
            char name[] = {'s', 'u', 'y', 'a', 'n', 'g'}; //错误的字符串写法
          </code>
        </pre>
        <section class="提醒">
          <h3 class="提醒标题">提醒</h3>
          <p class="分区普通文本">这种写法是<span class="强调">错</span>的：</p>
          <pre class="line-numbers">
            <code class="lang-c">
              // []内不写数字，如果强行将其当做字符串对待，
              // 编译器会在'g'后继续读取字符，直到在内存中读到'\0'
              // 而'g'后面是什么无法预知，因此会导致乱码和错误
              char name[] = {'s', 'u', 'y', 'a', 'n', 'g'}; //不是字符串
            </code>
          </pre>
          <figure class="截图容器">
            <img
              src="/Images/Blogs/C语言/数组字符串和指针字符串/输出字符串内容和长度_乱码-错误.png"
              alt="字符串乱码和错误"
            />
          </figure>
          <p class="分区普通文本">
            第 8 行的<span class="代码">char[]</span>方括号内没有显式指定长度，编译器会按照元素数量计算长度，长度为 6
            。因为最后一个字符不是<span class="代码">'\0'</span>，所以<span class="行内代码">name</span
            ><span class="强调" style="margin-left: 0">不是字符串</span>，只是一个<span class="行内专业名词"
              >字符数组</span
            >。
          </p>
        </section>
      </li>
      <li class="分区列表项">
        双引号字符串
        <p class="分区普通文本">
          双引号字符串有个特点，会自动在最后添加一个<span class="代码">'\0'</span>字符<span class="附加说明"
            >平时不可见</span
          >，因此初始化时，数组长度可写可不写。
        </p>
        <pre class="line-numbers">
          <code class="lang-c">
            // 以下两种写法的效果完全一致
            char name_without_length[] = "suyang";
            char name_with_length[7] = "suyang";
          </code>
        </pre>
        <figure class="截图容器">
          <img src="/Images/Blogs/C语言/数组字符串和指针字符串/双引号字符串初始化.png" alt="双引号字符串初始化" />
        </figure>
        <section class="提醒">
          <h3 class="提醒标题">提醒</h3>
          <p class="分区普通文本">
            <span class="代码">"suyang"</span>等价于<span class="代码">{ 's', 'u', 'y', 'a', 'n', 'g', '\0' }</span
            >。双引号的写法既方便，又安全，因此除非特殊情况，初始化字符串建议使用双引号写法。
          </p>
        </section>
      </li>
    </ul>

    <h3 class="分区标题 分区3级标题">修改数组字符串变量</h3>
    <p class="分区普通文本">
      <span class="行内专业名词">1-2</span
      >中提到，数组字符串变量本质上是数组名称，不是指针，只是可以作为指针使用。而数组名称变量是不可以修改的。
    </p>
    <pre class="line-numbers">
      <code class="lang-c">
        // 以下两种写法的效果完全一致
        char name[] = "suyang";
        name = "Hacker"; //这一句会报错，name不可修改
      </code>
    </pre>
    <figure class="截图容器">
      <img
        src="/Images/Blogs/C语言/数组字符串和指针字符串/数组字符串重新赋值编译器错误.png"
        alt="数组字符串重新赋值编译器错误"
      />
    </figure>
    <p class="分区普通文本">
      编译器给出错误提示：<br /><span class="代码" style="color: white"
        ><span class="强调">error: </span>assignment to expression with array type</span
      ><span class="代码" style="color: white"><span class="强调">错误: </span>向数组类型赋值</span
      >。<br />这再次证明了<span class="行内代码">name</span>是数组，不是指针。
    </p>
    <p class="分区普通文本">我们还可以通过输出内存地址来看清楚这一点：</p>
    <figure class="截图容器">
      <img
        src="/Images/Blogs/C语言/数组字符串和指针字符串/数组字符串变量自身地址和保存的地址.png"
        alt="数组字符串变量自身地址和保存的地址"
      />
    </figure>
    <p class="分区普通文本">
      <span class="代码">name</span>自身的地址和保存的地址是一致的，说明<span class="行内代码">name</span>本身就是数组。
    </p>

    <h3 class="分区标题 分区3级标题">修改数组字符串对象</h3>
    <p class="分区普通文本">数组对象分配在内存栈上，因此可以修改：</p>
    <pre class="line-numbers">
      <code class="lang-c">
        // 以下两种写法的效果完全一致
        char name[] = "suyang";
        name[0] = 'H';
        name[1] = 'a';
        name[2] = 'c';
        name[3] = 'k';
        name[4] = 'e';
        name[5] = 'r';
        // name[6] 是 '\0'，虽然可以改，但是不能改！改了就不是字符串了
      </code>
    </pre>
    <figure class="截图容器">
      <img src="/Images/Blogs/C语言/数组字符串和指针字符串/修改数组字符串对象.png" alt="修改数组字符串对象" />
    </figure>
    <p class="分区普通文本">数组中的元素，都可以重新赋值。</p>
    <section class="提醒">
      <h3 class="提醒标题">提醒</h3>
      <p class="分区普通文本">
        <span class="强调">始终牢记</span>：数组字符串的最后一个字符是<span class="代码">'\0'</span
        >，这个字符不能修改。只有以<span class="代码">'\0'</span>结尾的字符数组，才是字符串。
      </p>
    </section>
  </article>

  <article class="正文分区">
    <h2 class="分区标题 分区2级标题">指针字符串</h2>

    <h3 class="分区标题 分区3级标题">初始化</h3>
    <pre class="line-numbers">
      <code class="lang-c">
        // "suyang"依然以隐式的'\0'字符结尾
        char* name = "suyang"; // name是真正的指针类型
      </code>
    </pre>
    <p class="分区普通文本">
      看起来语法差别不大，但<span class="代码">name</span>的本质却不同。这里的<span class="行内代码">name</span
      >是个真正的指针，分配在内存栈上，它<span class="强调">指向</span><span class="行内代码">"suyang"</span>，但<span
        class="强调"
        >不是</span
      ><span class="行内代码">"suyang"</span>。<span class="代码">"suyang"</span>对象被分配在内存静态存储区，无法修改。
    </p>
    <figure class="截图容器">
      <img
        src="/Images/Blogs/C语言/数组字符串和指针字符串/指针字符串变量与对象内存地址.png"
        alt="指针字符串变量与对象内存地址"
      />
    </figure>
    <p class="分区普通文本">
      <span class="行内代码">name</span>和<span class="行内代码">"suyang"</span>分别位于内存的不同地址。
    </p>

    <h3 class="分区标题 分区3级标题">修改指针字符串变量</h3>
    <p class="分区普通文本"><span class="代码">char*</span>类型是真正的指针，因此可以重新赋值：</p>
    <pre class="line-numbers">
      <code class="lang-c">
        char* name = "suyang"; // name 指向 "suyang"
        name = "Hacker"; // name 改为指向 "Hacker"
      </code>
    </pre>
    <figure class="截图容器">
      <img src="/Images/Blogs/C语言/数组字符串和指针字符串/修改指针字符串变量.png" alt="修改指针字符串变量" />
    </figure>
    <p class="分区普通文本">
      <span class="代码">name</span>指向的对象从<span class="行内代码">"suyang"</span>变成了<span class="行内代码"
        >"Hacker"</span
      >，实际上是更新了<span class="代码">name</span>保存的内存地址<span class="附加说明"
        ><span class="行内代码">"suyang"</span>的内存地址<i
          class="fa-solid fa-right-long"
          style="color: gold; margin: 0 5px"
        ></i
        ><span class="行内代码">"Hacker"</span>的内存地址</span
      >。
    </p>
    <figure class="截图容器">
      <img
        src="/Images/Blogs/C语言/数组字符串和指针字符串/修改指针字符串变量的本质.png"
        alt="修改指针字符串变量的本质"
      />
    </figure>
    <p class="分区普通文本">这段代码可以用动画表示：</p>
    <figure class="截图容器">
      <img
        src="/Images/Blogs/C语言/数组字符串和指针字符串/修改指针字符串变量动画.webp"
        alt="修改指针字符串变量动画"
        style="background-color: #151515"
      />
    </figure>
    <p class="分区普通文本">
      修改<span class="代码">name</span>，并没有修改<span class="行内代码">"suyang"</span
      >，而是在静态存储区生成一个新字符串<span class="行内代码">"Hacker"</span>并更新<span class="行内代码">name</span
      >保存的内存地址。
    </p>

    <h3 class="分区标题 分区3级标题">修改指针字符串对象</h3>
    <p class="分区普通文本">
      <span class="代码">char* name = "suyang"</span>里的<span class="行内代码">"suyang"</span
      >分配在内存静态存储区，是无法修改的。
    </p>
    <pre class="line-numbers">
      <code class="lang-c">
        char* name = "suyang";

        // 错误，"suyang"分配在静态存储区，内部数据无法修改
        // 强行修改会产生未知效果
        name[0] = 'H';
      </code>
    </pre>
    <figure class="截图容器">
      <img src="/Images/Blogs/C语言/数组字符串和指针字符串/按数组方式修改指针.webp" alt="按数组方式修改指针" />
    </figure>
    <p class="分区普通文本">修改之后可能出现各种莫名其妙的结果，但都是不符合预期的。</p>
  </article>
</div>
